<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Spelling Checker - Beta 2.1</title>
<style>
/* --- General Reset & Layout --- */
body {
font-family: 'Arial', sans-serif;
display: flex;
flex-direction: column;
align-items: center;
padding: 20px;
min-height: 100vh;
background-color: #f4f4f9; /* Light mode default */
color: #333;
transition: background-color 0.3s, color 0.3s;
}

h1 {
color: #007bff;
margin-bottom: 5px;
}

/* --- Dark Mode CSS --- */
.dark-mode {
background-color: #1e1e1e;
color: #f0f0f0;
}

.dark-mode h1 {
color: #90b8ff;
}

.dark-mode button, .dark-mode input {
background-color: #333;
color: #f0f0f0;
border: 1px solid #555;
}

.dark-mode .stats-box {
background-color: #2a2a2a;
border: 1px solid #444;
}

/* --- Container & Components --- */
.container {
width: 100%;
max-width: 600px;
background: #fff;
padding: 25px;
border-radius: 8px;
box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}

.stats-box {
background: #eef;
padding: 15px;
border-radius: 6px;
margin-bottom: 20px;
text-align: center;
}

#word-context-sentence {
font-size: 1.5em;
margin: 20px 0;
padding: 10px;
min-height: 50px; /* Prevent layout shift */
}

#word-context-sentence u {
font-weight: bold;
color: #dc3545; /* Highlight the misspelled word in red */
}

/* --- Input & Buttons --- */
#user-input {
width: calc(100% - 20px);
padding: 10px;
margin-bottom: 15px;
font-size: 1.2em;
border: 2px solid #ccc;
border-radius: 4px;
}

.controls {
display: flex;
gap: 10px;
justify-content: center;
margin-bottom: 20px;
}

button {
padding: 10px 15px;
font-size: 1em;
cursor: pointer;
border: none;
border-radius: 4px;
background-color: #007bff;
color: white;
transition: background-color 0.2s;
}

button:hover {
background-color: #0056b3;
}

/* Mode and Duration Selectors */
.mode-selector, .duration-selector {
display: flex;
gap: 10px;
margin-bottom: 15px;
justify-content: center;
}
.mode-selector button, .duration-selector button {
background-color: #6c757d;
}
.mode-selector button.active, .duration-selector button.active {
background-color: #28a745; /* Green for active state */
}

</style>
</head>
<body>

<div class="container">
<h1>Spelling Checker</h1>
<p>Creator Asif Saimun | Beta version 2.1</p>

<div class="mode-selector">
<button id="mode-practice" class="active">Practice</button>
<button id="mode-sprint">Sprint</button>
</div>

<div class="duration-selector" id="sprint-duration-selector" style="display: none;">
<button data-duration="30">30s</button>
<button data-duration="45" class="active">45s</button>
<button data-duration="60">60s</button>
<button data-duration="90">90s</button>
</div>

<div class="stats-box">
<p>Mode: <span id="current-mode-display">Practice</span></p>
<p>Time Left: <span id="timer-display">--</span> | Correct: <span id="correct-count">0</span> | Attempts: <span id="attempt-count">0</span></p>
</div>

<div style="text-align: center;">
<p id="word-context-sentence">Press **Start** to begin.</p>
</div>

<input type="text" id="user-input" placeholder="Type the correct word here..." disabled>

<div class="controls">
<button id="start-btn">Start</button>
<button id="skip-btn" disabled>Skip</button>
<button id="pause-btn" disabled>Pause</button>
<button id="reset-btn">Reset</button>
</div>

<hr>

<div class="stats-box">
<h3>Progress Tracker</h3>
<p>High Score (Sprint): <span id="global-high-score">0</span></p>
<p>Session Accuracy: <span id="accuracy-display">0%</span></p>
</div>

<button id="theme-toggle" style="margin-top: 20px;">Toggle Dark Mode 🌙</button>

</div>

<script>
// --- Word Data (Sample for Contextual Practice) ---
const contextualWords = [
{ misspelled: "prinsipal", correct: "principal", context: "The $\text{\underline{prinsipal}}$ reason for the delay was traffic." },
{ misspelled: "seperate", correct: "separate", context: "Please try to $\text{\underline{seperate}}$ the trash from the recycling." },
{ misspelled: "definitly", correct: "definitely", context: "I $\text{\underline{definitly}}$ want to go to the party tonight." },
{ misspelled: "acknowlege", correct: "acknowledge", context: "You should $\text{\underline{acknowlege}}$ their effort." },
{ misspelled: "recieve", correct: "receive", context: "Did you $\text{\underline{recieve}}$ the package I sent?" },
{ misspelled: "occassion", correct: "occasion", context: "It was a very special $\text{\underline{occassion}}$." },
];

// --- DOM Elements ---
const body = document.body;
const themeToggle = document.getElementById('theme-toggle');
const startBtn = document.getElementById('start-btn');
const skipBtn = document.getElementById('skip-btn');
const userInput = document.getElementById('user-input');
const wordDisplay = document.getElementById('word-context-sentence');
const correctCountDisplay = document.getElementById('correct-count');
const attemptCountDisplay = document.getElementById('attempt-count');
const accuracyDisplay = document.getElementById('accuracy-display');
const globalHighScoreDisplay = document.getElementById('global-high-score');
const timerDisplay = document.getElementById('timer-display');
const modeDisplay = document.getElementById('current-mode-display');
const durationSelector = document.getElementById('sprint-duration-selector');

// --- State Variables ---
let currentWord = null;
let isRunning = false;
let isSprintMode = false;
let score = 0;
let attempts = 0;
let correctAnswers = 0;
let timer = 0;
let countdownInterval = null;
let sprintDuration = 45; // Default duration

// --- Initialization ---
let globalHighScore = localStorage.getItem('spellcheckerHighScore') || 0;
globalHighScoreDisplay.textContent = globalHighScore;

// 1. Dark Mode Setup
function setupDarkMode() {
const savedTheme = localStorage.getItem('theme');
if (savedTheme === 'dark') {
body.classList.add('dark-mode');
themeToggle.textContent = 'Toggle Light Mode ☀️';
}
themeToggle.addEventListener('click', () => {
body.classList.toggle('dark-mode');
const isDarkMode = body.classList.contains('dark-mode');
themeToggle.textContent = isDarkMode ? 'Toggle Light Mode ☀️' : 'Toggle Dark Mode 🌙';
localStorage.setItem('theme', isDarkMode ? 'dark' : 'light');
});
}
setupDarkMode();

// 2. Mode and Duration Handlers
document.querySelectorAll('.mode-selector button').forEach(button => {
button.addEventListener('click', (e) => {
document.querySelector('.mode-selector button.active').classList.remove('active');
e.target.classList.add('active');

isSprintMode = (e.target.id === 'mode-sprint');
modeDisplay.textContent = isSprintMode ? 'Sprint' : 'Practice';
durationSelector.style.display = isSprintMode ? 'flex' : 'none';
resetGame();
});
});

durationSelector.querySelectorAll('button').forEach(button => {
button.addEventListener('click', (e) => {
durationSelector.querySelector('button.active').classList.remove('active');
e.target.classList.add('active');
sprintDuration = parseInt(e.target.dataset.duration);
resetGame();
});
});


// --- Core Game Functions ---

function loadNextWord() {
// Get a random word object
const wordData = contextualWords[Math.floor(Math.random() * contextualWords.length)];
currentWord = wordData.correct.toLowerCase();

// Display the sentence, highlighting the misspelled word
const highlightedContext = wordData.context.replace(
wordData.misspelled,
`<u>${wordData.misspelled}</u>`
);
wordDisplay.innerHTML = highlightedContext;

userInput.value = '';
userInput.focus();
}

function checkInput() {
if (!isRunning) return;

const submission = userInput.value.trim().toLowerCase();

if (submission === currentWord) {
correctAnswers++;
attempts++;
score = correctAnswers; // Score is just correct answers in sprint mode
updateStats();
loadNextWord();
// Optional: Provide visual feedback for correct answer
} else if (submission.length > 0) {
attempts++;
updateStats();
// Optional: Provide visual feedback for wrong answer (e.g., shake the input box)
}

// In Practice mode, only update if the word is correct
if (!isSprintMode && submission === currentWord) {
loadNextWord();
} else if (!isSprintMode) {
// In Practice mode, user must submit the correct word to proceed.
}
}

function updateStats() {
correctCountDisplay.textContent = correctAnswers;
attemptCountDisplay.textContent = attempts;

let accuracy = attempts > 0 ? ((correctAnswers / attempts) * 100).toFixed(0) : 0;
accuracyDisplay.textContent = `${accuracy}%`;

// Update Global High Score (only if in Sprint mode)
if (isSprintMode && score > globalHighScore) {
globalHighScore = score;
localStorage.setItem('spellcheckerHighScore', globalHighScore);
globalHighScoreDisplay.textContent = globalHighScore;
}
}

function startGame() {
if (isRunning) return;

isRunning = true;
score = 0;
correctAnswers = 0;
attempts = 0;

startBtn.textContent = 'Stop';
userInput.disabled = false;
skipBtn.disabled = false;
pauseBtn.disabled = false;

updateStats();
loadNextWord();

if (isSprintMode) {
timer = sprintDuration;
timerDisplay.textContent = timer;
countdownInterval = setInterval(() => {
timer--;
timerDisplay.textContent = timer;
if (timer <= 0) {
endGame();
}
}, 1000);
} else {
timerDisplay.textContent = '∞';
}
}

function endGame() {
isRunning = false;
clearInterval(countdownInterval);
userInput.disabled = true;
skipBtn.disabled = true;
pauseBtn.disabled = true;
startBtn.textContent = 'Start';
timerDisplay.textContent = '--';

if (isSprintMode) {
wordDisplay.innerHTML = `**Time's up!** Your final score: **${score}** correct words.`;
} else {
wordDisplay.innerHTML = `**Session Stopped.** Press Start to continue.`;
}

// Re-update to ensure high score is saved
updateStats();
}

function resetGame() {
endGame();
correctAnswers = 0;
attempts = 0;
score = 0;
userInput.value = '';
updateStats();
wordDisplay.innerHTML = isSprintMode ?
`**Sprint Mode** (${sprintDuration}s). Press Start to begin.` :
`**Practice Mode**. Press Start to begin.`;
timerDisplay.textContent = isSprintMode ? sprintDuration : '--';
}


// --- Event Listeners ---
startBtn.addEventListener('click', () => {
if (isRunning) {
endGame();
} else {
startGame();
}
});

skipBtn.addEventListener('click', () => {
if (isRunning) {
attempts++; // Count skipped as an attempt (optional logic)
updateStats();
loadNextWord();
}
});

// Use Enter key to submit
userInput.addEventListener('keypress', (e) => {
if (e.key === 'Enter') {
checkInput();
e.preventDefault(); // Prevent form submission if in a form
}
});

document.getElementById('reset-btn').addEventListener('click', resetGame);

// Initial setup on load
resetGame();

</script>
</body>
</html>
